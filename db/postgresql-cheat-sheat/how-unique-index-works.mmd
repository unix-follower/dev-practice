flowchart TD
    A[Start: Insert or Update Operation]
    B["Check for Unique Index on Target Column(s)"]
    A --> B

    C{Is Unique Index Present?}
    B --> C

    C -->|Yes| D[PostgreSQL Checks Index for Duplicate Values]
    C -->|No| E[Proceed Without Uniqueness Enforcement]

    D --> F{Are Duplicate Values Found?}
    F -->|Yes| G[Reject Operation: Raise Unique Constraint Error]
    F -->|No| H[Allow Insert/Update; Update Unique Index]

    D --> K{Is Unique Index defined with NULLS DISTINCT or NULLS NOT DISTINCT?}
    K -->|NULLS DISTINCT| L[NULL values are treated as distinct; multiple NULLs allowed]
    K -->|NULLS NOT DISTINCT| M[NULL values are not distinct; only one NULL allowed]

    E --> H
    G --> I[Return Error to Application]
    H --> J[Return Success to Application]
    L --> J
    M --> G
